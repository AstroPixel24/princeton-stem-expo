<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration - Princeton STEM Expo (PSE)</title>
    <link rel="stylesheet" href="styles/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="icon" type="image/png" sizes="32x32" href="images/pselogofinal.jpg">
    <link rel="apple-touch-icon" href="images/pselogofinal.jpg">
</head>
<body>
    <header class="header">
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <a href="index.html#home" class="logo-link" aria-label="Princeton STEM Expo home">
                        <img src="images/pselogofinal.jpg" alt="Princeton STEM Expo logo" />
                    </a>
                </div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="index.html#home" class="nav-link">Home</a>
                    </li>
                    <li class="nav-item">
                        <a href="index.html#about" class="nav-link">About</a>
                    </li>
                    <li class="nav-item">
                        <a href="index.html#schedule" class="nav-link">Schedule</a>
                    </li>
                    <li class="nav-item">
                        <a href="registration.html" class="nav-link active">Registration</a>
                    </li>
                    <li class="nav-item">
                        <a href="archive.html" class="nav-link">Archive</a>
                    </li>
                    <li class="nav-item">
                        <a href="index.html#faq" class="nav-link">FAQ</a>
                    </li>
                    <li class="nav-item">
                        <a href="index.html#sponsors" class="nav-link">Sponsors</a>
                    </li>
                </ul>
                <div class="hamburger">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section class="page-header">
            <div class="container">
                <div class="status-pill status-pill-closed">
                    <i class="fas fa-lock"></i>
                    Registration Closed
                </div>
                <h1 class="page-title">Registration</h1>
                <p class="page-subtitle">PSE 2025 registration closed on September 20. Browse the 2025 recap and join the interest list below to be first in line for the 2026 launch.</p>
                <div class="page-event-info">
                    <div class="page-event-details">
                        <div class="event-detail">
                            <i class="fas fa-calendar-alt"></i>
                            <span>Saturday, September 27, 2025</span>
                        </div>
                        <div class="event-detail">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Community Middle School</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="page-content">
            <div class="container">
                <div class="content-section">
                    <div class="info-banner info-banner-closed" role="status" aria-live="polite">
                        <i class="fas fa-lock"></i>
                        <div class="info-banner-content">
                            <strong>PSE 2025 registration is officially closed.</strong>
                            <p>We're finalizing updates for 2026. In the meantime, explore the <a href="archive.html">2025 archive</a> and drop your email in the <a href="https://forms.gle/21KcFwHVqBWhSR35A" target="_blank" rel="noopener noreferrer">interest form</a> to be first to hear when we reopen.</p>
                        </div>
                    </div>
                    <div class="closure-card">
                        <div class="closure-card-header">
                            <i class="fas fa-bullhorn" aria-hidden="true"></i>
                            <div>
                                <h3>What to expect next</h3>
                                <p>Thank you for the overwhelming response to our inaugural year. Here's how to stay in the loop until registration reopens.</p>
                            </div>
                        </div>
                        <ul class="closure-card-list">
                            <li>
                                <i class="fas fa-check-circle" aria-hidden="true"></i>
                                Interest-list updates go out in early spring 2026 with exact dates and pricing.
                            </li>
                            <li>
                                <i class="fas fa-check-circle" aria-hidden="true"></i>
                                Priority reminders are sent to families who submit the <a class="inline-pill-link" href="https://forms.gle/21KcFwHVqBWhSR35A" target="_blank" rel="noopener noreferrer" aria-label="interest form">official interest form</a>.
                            </li>
                            <li>
                                <i class="fas fa-check-circle" aria-hidden="true"></i>
                                The registration form below stays locked so you can preview required information ahead of time.
                            </li>
                        </ul>
                        <div class="closure-actions">
                            <a class="closure-link" href="archive.html">
                                <i class="fas fa-up-right-from-square" aria-hidden="true"></i>
                                View 2025 Results
                            </a>
                            <a class="closure-link closure-link-accent" href="https://forms.gle/21KcFwHVqBWhSR35A" target="_blank" rel="noopener noreferrer">
                                <i class="fas fa-envelope" aria-hidden="true"></i>
                                Join the 2026 Interest List
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Registration Options -->
                <div class="content-section">
                    <h2>2025 Participation Snapshot</h2>
                    <p>Thank you to every student, family, and volunteer who packed the inaugural Princeton STEM Expo. Below is a quick look at what the 2025 cohort experienced so you can plan ahead for 2026.</p>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <h3>Student Registration</h3>
                            <p>Thanks to everyone who registered and made our debut competition a success.</p>
                            <ul style="text-align: left; margin: 1rem 0;">
                                <li>Participate in the math competition for students across New Jersey</li>
                                <li>Compete in your grade division (3rd, 4th, 5th, 6th, 7th, 8th)</li>
                                <li>Have a chance to place well and win over <b>$1000+</b> worth in subscriptions and other prizes!</li>
                                <li>Participate in amazing Mini Events and learn new STEM concepts</li>
                                <li>Guest speaker talk with CMU Professor, Po Shen-Loh</li>
                            </ul>
                            <div class="pricing">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #2563eb;">$25</div>
                            </div>
                            <p style="margin-top: 1rem; color: #475569;">Returning soon: refreshed pricing and workshop details for the 2026 cycle.</p>
                        </div>
                    </div>
                </div>

                <!-- Registration Form -->
                <div class="content-section">
                    <h2>Registration Form (Archived Preview)</h2>
                    <div class="alert-banner" style="padding: 1.25rem 1.5rem; border-radius: 16px; background: #fef2f2; border: 1px solid #fecaca; margin-bottom: 1.5rem;">
                        <p style="margin: 0; color: #991b1b; font-weight: 600;">
                            Registration closed on September 20, 2025. The form below is locked for reference only and cannot accept submissions.
                        </p>
                        <p style="margin: 0.35rem 0 0; color: #991b1b;">
                            Add your email through the <a href="https://forms.gle/21KcFwHVqBWhSR35A" target="_blank" rel="noopener noreferrer" style="color: inherit; font-weight: 600; text-decoration: underline;">PSE 2026 interest form</a> for priority updates and revisit the <a href="archive.html" style="color: inherit; font-weight: 600; text-decoration: underline;">2025 archive</a> for results.
                        </p>
                    </div>
                    
                    <div class="form-container">
                        <!-- UPDATED FORM: Now properly submits to Google Apps Script -->
                        <form id="registrationForm" method = "POST" action="https://script.google.com/macros/s/AKfycbyW4RoGyn6Ccgd0jRBfKvWUflkxqKSoeH95tJfc0OqOmfQZm369UE4Wsn-gYzCF5sp4/exec" aria-disabled="true">
                            <!-- Student Information -->
                            <h3>Student Information</h3>
                            <div class="form-group">
                                <label for="studentName">Student Full Name *</label>
                                <input type="text" id="studentName" name="Name" required disabled>
                            </div>

                            <div class="form-group">
                                <label for="grade">Grade Level *</label>
                                <select id="grade" name="Grade" required disabled>
                                    <option value="">Select grade</option>
                                    <option value="3">3rd Grade</option>
                                    <option value="4">4th Grade</option>
                                    <option value="5">5th Grade</option>
                                    <option value="6">6th Grade</option>
                                    <option value="7">7th Grade</option>
                                    <option value="8">8th Grade</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="school">School Name *</label>
                                <input type="text" id="school" name="School Name" required disabled>
                            </div>

                            <div class="form-group">
                                <label for="studentEmail">Student Email</label>
                                <input type="email" id="studentEmail" name="Student Email" disabled>
                            </div>

                            <!-- Parent/Guardian Information -->
                            <h3>Parent/Guardian Information</h3>
                            <div class="form-group">
                                <label for="parentName">Parent/Guardian Name *</label>
                                <input type="text" id="parentName" name="Parent Name" required disabled>
                            </div>

                            <div class="form-group">
                                <label for="parentEmail">Parent/Guardian Email *</label>
                                <input type="email" id="parentEmail" name="Parent Email" required disabled>
                            </div>

                            <div class="form-group">
                                <label for="parentPhone">Parent/Guardian Phone *</label>
                                <input type="tel" id="parentPhone" name="Parent Phone" required disabled>
                            </div>

                            <!-- Emergency Contact -->
                            <h3>Emergency Contact</h3>
                            <div class="form-group">
                                <label for="emergencyName">Emergency Contact Name *</label>
                                <input type="text" id="emergencyName" name="Emergency Contact Name" required disabled>
                            </div>

                            <div class="form-group">
                                <label for="emergencyPhone">Emergency Contact Phone *</label>
                                <input type="tel" id="emergencyPhone" name="Emergency Contact Phone" required disabled>
                            </div>

                            <div class="form-group">
                                <label for="emergencyRelation">Relationship to Student *</label>
                                <input type="text" id="emergencyRelation" name="Relationship to Student" required disabled>
                            </div>

                            <!-- Additional Information -->
                            <h3>Additional Information</h3>
                            <div class="form-group">
                                <label for="dietary">Dietary Restrictions/Food Allergies</label>
                                <textarea id="dietary" name="Dietary Info" placeholder="Please list any dietary restrictions, food allergies, or special meal requirements" disabled></textarea>
                            </div>

                            <div class="form-group">
                                <label for="medical">Medical Conditions/Accommodations</label>
                                <textarea id="medical" name="Medical Conditions" placeholder="Please describe any medical conditions, learning accommodations, or special needs" disabled></textarea>
                            </div>

                            <!-- Agreements & Permissions -->
                            <h3>Agreements & Permissions</h3>
                            <div class="form-group">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="liability" name="Liability Waiver" required disabled>
                                    <label for="liability">I agree to the liability waiver and understand that participation is at my own risk. *</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="photography" name="Photography Permission" disabled>
                                    <label for="photography">I give permission for photographs taken during the event to be used for promotional purposes.</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="communication" name="Communication Permission" disabled>
                                    <label for="communication">I would like to receive updates about future PSE events and STEM opportunities.</label>
                                </div>
                            </div>

                            <!-- Submit Button -->
                            <div class="form-group">
                                <button type="submit" id="submitBtn" class="btn btn-primary" style="width: 100%; padding: 1rem; font-size: 1.1rem;" disabled>Registration Closed</button>
                            </div>

                            <p style="font-size: 0.9rem; color: #64748b; text-align: center; margin-top: 1rem;">
                                Payment instructions and confirmation emails will resume when registration reopens.
                            </p>
                            
                        </form>
                        
                        <!-- Success message -->
                        <div id="successMessage" style="display: none; text-align: center; margin-top: 2rem; padding: 1.5rem; background: #f0fdf4; border: 2px solid #22c55e; border-radius: 8px;">
                            <p style="color: #166534; font-size: 1.1rem; margin: 0;">
                                ✅ Thank you for registering! A confirmation email has been sent.
                            </p>
                        </div>

                        <!-- Error message -->
                        <div id="errorMessage" style="display: none; text-align: center; margin-top: 2rem; padding: 1.5rem; background: #fef2f2; border: 2px solid #ef4444; border-radius: 8px;">
                            <p style="color: #991b1b; font-size: 1.1rem; margin: 0;">
                                ❌ There was an error submitting your registration. Please try again.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Important Dates & Information -->
                <div class="content-section">
                    <h2>Important Dates & Deadlines</h2>
                    <div class="resource-grid">
                        <div class="resource-card">
                            <h3><i class="fas fa-calendar-alt"></i> Registration Opens</h3>
                            <p><strong>July 15, 2025</strong></p>
                            <p>Online registration begins for all participants</p>
                        </div>
                        
                        <div class="resource-card">
                            <h3><i class="fas fa-exclamation-triangle"></i> Registration Closes</h3>
                            <p><strong>September 20, 2025</strong></p>
                            <p>Final deadline - no registrations accepted after this date</p>
                        </div>
                    </div>
                </div>

            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Princeton STEM Expo</h3>
                    <p>Empowering the next generation of STEM leaders through mathematics and innovation.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html#about">About</a></li>
                        <li><a href="index.html#schedule">Schedule</a></li>
                        <li><a href="registration.html">Registration</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact</h4>
                    <p>Email: princetonstemexpo@gmail.com</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Princeton STEM Expo. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="js/script.js"></script>
    
    <script>
        // UPDATED SCRIPT: Properly submits to Google Apps Script
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('registrationForm');
            const submitBtn = document.getElementById('submitBtn');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');
            
            // Your Google Apps Script URL
            const scriptURL = 'https://script.google.com/macros/s/AKfycbz8mw81tCVrtG60JooQL7dVE81Sc6kHCox25Jk7TSgk2yeZR_TBeRMvR-Dy2rcxhSSz/exec';

            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                console.log('=== FORM SUBMISSION STARTED ===');
                
                // Validate required fields
                const requiredFields = form.querySelectorAll('[required]');
                let isValid = true;
                
                requiredFields.forEach(field => {
                    if (!field.value.trim()) {
                        isValid = false;
                        field.style.borderColor = '#ef4444';
                        field.style.boxShadow = '0 0 0 1px #ef4444';
                    } else {
                        field.style.borderColor = '#e2e8f0';
                        field.style.boxShadow = 'none';
                    }
                });

                if (!isValid) {
                    alert('Please fill in all required fields marked with *');
                    return;
                }

                // Show loading state
                submitBtn.textContent = 'Submitting...';
                submitBtn.disabled = true;
                submitBtn.style.opacity = '0.7';
                
                // Hide previous messages
                successMessage.style.display = 'none';
                errorMessage.style.display = 'none';

                // Prepare form data
                const formData = new FormData(form);
                
                // Handle checkboxes properly
                formData.set('Liability Waiver', document.getElementById('liability').checked ? 'Yes' : 'No');
                formData.set('Photography Permission', document.getElementById('photography').checked ? 'Yes' : 'No');
                formData.set('Communication Permission', document.getElementById('communication').checked ? 'Yes' : 'No');
                
                // Debug: Log form data
                console.log('Form data being sent:');
                for (let [key, value] of formData.entries()) {
                    console.log(key + ': ' + value);
                }

                // Submit to Google Apps Script
                fetch(scriptURL, {
                    method: 'POST',
                    body: formData
                })
                .then(response => {
                    console.log('Response status:', response.status);
                    return response.text();
                })
                .then(result => {
                    console.log('Response from server:', result);
                    
                    try {
                        const jsonResult = JSON.parse(result);
                        if (jsonResult.result === 'success') {
                            // Success!
                            console.log('✅ Registration successful!');
                            form.reset();
                            successMessage.style.display = 'block';
                            successMessage.scrollIntoView({ behavior: 'smooth' });
                            
                            // Hide success message after 10 seconds
                            setTimeout(() => {
                                successMessage.style.display = 'none';
                            }, 10000);
                        } else {
                            throw new Error(jsonResult.error || 'Unknown error');
                        }
                    } catch (parseError) {
                        // If response isn't JSON, check if it contains success indicators
                        if (result.toLowerCase().includes('success')) {
                            console.log('✅ Registration successful (non-JSON response)');
                            form.reset();
                            successMessage.style.display = 'block';
                            successMessage.scrollIntoView({ behavior: 'smooth' });
                        } else {
                            throw new Error('Server response: ' + result);
                        }
                    }
                })
                .catch(error => {
                    console.error('❌ Submission error:', error);
                    errorMessage.style.display = 'block';
                    errorMessage.scrollIntoView({ behavior: 'smooth' });
                    
                    // Hide error message after 10 seconds
                    setTimeout(() => {
                        errorMessage.style.display = 'none';
                    }, 10000);
                })
                .finally(() => {
                    // Reset button state
                    submitBtn.textContent = 'Complete Registration';
                    submitBtn.disabled = false;
                    submitBtn.style.opacity = '1';
                });
            });
        });
    </script>
</body>
</html>
